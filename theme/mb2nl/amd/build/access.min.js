/**
 *
 * @package   theme_mb2nl
 * @copyright 2017 - 2024 Mariusz Boloz (lmsstyle.com)
 * @license   PHP and HTML: http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later. Other parts: http://themeforest.net/licenses
*/ define(["jquery","theme_mb2nl/userpreference"],function(t,a){"use strict";var s=function(a){var s=a.keyCode?a.keyCode:a.which,e='a,button,[type="submit"],input,textarea,.nav-link';t(document).on("focus",e,function(a){"true"!==t("body").attr("data-keydown")||t("body").hasClass("pagelayout-mb2builder")||9!=s||t(this).addClass("themefocused"),t("body").attr("data-keydown","false")}),t(""+e).focusout(function(){t(this).removeClass("themefocused")})},e=function(s){var e=t('.acsb-button[data-id="'+s+'"]');if(!e.hasClass("active"))return null;e.removeClass("active"),e.attr("aria-checked","false"),t("html").removeClass("acsb_"+s),"readingmask"===s&&t(".acsb_mask").remove(),("contrastdark"===s||"contrastlight"===s)&&k(),"readingguide"===s&&t(".acsb_readinguide-el").remove(),"tooltips"===s&&t(".acsb_tooltip-el").remove(),a.sePreference("acsb_"+s,0)},c=function(s){t('.acsb-button[data-id="'+s+'"]').addClass("active"),t('.acsb-button[data-id="'+s+'"]').attr("aria-checked","true"),t("html").addClass("acsb_"+s),"readingmask"===s&&i(),"readingguide"===s&&n(),"tooltips"===s&&u(),a.sePreference("acsb_"+s,1);var c=t('.acsb-button[data-id="'+s+'"]').attr("data-disable").split(",");if(c.length)for(var o=0;o<c.length;o++)e(c[o]);("contrastdark"===s||"contrastlight"===s)&&g()},i=function(){var a="";o(),a+='<div class="acsb_mask acsb_masktop"></div>',a+='<div class="acsb_mask acsb_maskbottom"></div>',t("body").append(a)},n=function(){var a="";r(),a+='<div class="acsb_readinguide-el"></div>',t("body").append(a)},o=function(){var a=t(window);a.on("mousemove",function(s){t(".acsb_masktop").css("height",s.clientY-40),t(".acsb_maskbottom").css("height",a.height()-s.clientY-40)})},r=function(){t(window).on("mousemove",function(a){t(".acsb_readinguide-el").css("top",a.clientY+10)})},l=function(){t(document).on("click",".acsb-reset",function(a){h(),t(".acsb-button").each(function(){e(t(this).attr("data-id"))})})},d=function(){t(window).on("mousemove",function(a){var s=t(".acsb_tooltip-el"),e=s.outerHeight(!0),c=s.outerWidth(!0),i=a.clientY+15,n=a.clientX+15,o=i+e>t(window).height(),r=n+210>t(window).width(),l=n<c;o&&(i=a.clientY-e-15),r&&!l&&(n=a.clientX-15-c),r&&l&&(n=0),s.css("top",i),s.css("left",n)}),t(document).on("mousemove","[title],[alt],[aria-label]",function(a){var s=b(t(this));if(!s)return null;t(".acsb_tooltip-el").html(s),t(".acsb_tooltip-el").css("opacity",1)}),t(document).on("mouseout","[title],[alt],[aria-label]",function(a){t(".acsb_tooltip-el").css("opacity",0)})},b=function(t){var a=t.attr("alt");return t.attr("title")?a=t.attr("title"):t.attr("aria-label")&&(a=t.attr("aria-label")),a},u=function(){t(".acsb_tooltip-el").length||t("body").append('<div class="acsb_tooltip-el"></div>'),d()},h=function(){t(".acsb-profile-item").each(function(){var s=t(this),c=s.attr("data-acsb").split(",");if(!s.hasClass("active"))return null;for(var i=0;i<c.length;i++)e(c[i]);s.removeClass("active"),s.attr("aria-checked","false"),a.sePreference("acsb_"+s.attr("data-id"),0)})},f=function(){var a=0;return t(".acsb-button").each(function(){t(this).hasClass("active")&&(a=1)}),a},v=function(){t(".acsb-block").removeClass("visible");var s=t(".acsb-trigger");f()&&!s.hasClass("active")?(s.addClass("active"),a.sePreference("acsb_trigger",1)):!f()&&s.hasClass("active")&&(s.removeClass("active"),a.sePreference("acsb_trigger",0),h())},m=function(t,s){for(var i=t,n=i.attr("data-acsb").split(","),o=0,r=0;r<n.length;r++)s?c(n[r]):e(n[r]);s?(i.addClass("active"),i.attr("aria-checked","true")):(i.removeClass("active"),i.attr("aria-checked","false")),s&&(o=1),a.sePreference("acsb_"+i.attr("data-id"),o)},g=function(){var a=C();t(a.join()).addClass("mb2scsb-contrast")},k=function(){t(".mb2scsb-contrast").removeClass("mb2scsb-contrast")},C=function(){return jsselectors};return{focusClass:function(){t(window).on("keydown",function(a){t("body").attr("data-keydown","true"),s(a)})},acsbTools:function(){t(document).on("click",".acsb-trigger",function(a){var s=t(".acsb-block");s.hasClass("visible")||s.addClass("visible")}),t(document).on("click",".acsb-block-close",function(t){v()}),t("body").on("click",function(a){var s=t(a.target);s.closest(".acsb-block").length||s.closest(".acsb-trigger").length||v()}),t(document).on("click",".acsb-title",function(a){var s=t(this).closest(".acsb-section");s.hasClass("hct")?(s.removeClass("hct"),t(this).attr("aria-expanded","true")):(s.addClass("hct"),t(this).attr("aria-expanded","false"))}),t(document).on("click",".acsb-profile-item",function(a){t(this).hasClass("active")?m(t(this),0):(h(),m(t(this),1))}),t(document).on("click",".acsb-button",function(a){var s=t(this).attr("data-id");t(this).hasClass("active")?e(s):c(s)}),t("html").hasClass("acsb_readingmask")&&i(),t("html").hasClass("acsb_readingguide")&&n(),t("html").hasClass("acsb_tooltips")&&u(),(t("html").hasClass("acsb_contrastdark")||t("html").hasClass("acsb_contrastlight"))&&g(),l()}}});