/**
 *
 * @package   theme_mb2nl
 * @copyright 2017 - 2024 Mariusz Boloz (lmsstyle.com)
 * @license   Commercial https://themeforest.net/licenses
*/ define(["jquery","core/ajax","core/notification"],function(e,t,a){"use strict";let i=e("#page"),n=e("form.theme-course-filter .inner"),r=()=>{(()=>{let e={categoryid:i.attr("data-uparam_categoryid"),tagid:i.attr("data-uparam_tagid"),teacherid:i.attr("data-uparam_teacherid")};return t.call([{methodname:"theme_mb2nl_course_filters",args:e}])[0]})().then(e=>{n.append(e.filters),x(),o()}).catch(Notification.exception)},c=(a=1,i="")=>{let n=e("form.theme-course-filter"),r=n.find("[disabled]");r.removeAttr("disabled");let c=n.serialize();return r.attr("disabled","disabled"),t.call([{methodname:"theme_mb2nl_course_list",args:{formdata:c,page:a,searchstr:i}}])[0]},o=()=>{h(!0),c().then(e=>{d(e)}).catch(Notification.exception)};var s,l,u,f=function(){e(document).on("click",".toggle-list-btn",function(){var t=e(this).closest(".filter-form-field");t.hasClass("active")?(t.removeClass("active"),e(this).attr("aria-expanded","false")):(t.addClass("active"),e(this).attr("aria-expanded","true"))})},d=function(t){setTimeout(function(){e(m().container).empty(),e(m().container).append(t.courses),h(!1)},850)},m=function(){return{container:".courses-container-inner",courselist:".theme-courses-list"}},h=function(t){t?e(m().container).addClass("loading"):e(m().container).removeClass("loading")},p=function(){e("html, body").stop().animate({scrollTop:e(m().container).offset().top-165},650)},g=function(){e(document).on("click",".filter-toggle",function(){var t=e(".cfilter-wrap");t.hasClass("active")?(t.removeClass("active"),e(this).attr("aria-expanded","false")):(t.addClass("active"),e(this).attr("aria-expanded","true"))}),e(document).on("click",".filter-close",function(){e(".cfilter-wrap").removeClass("active"),e(".filter-toggle").attr("aria-expanded","false")})},v=function(){b(),e(document).on("change",".mb2filter-inpt",function(){b()})},b=function(){let t=e(".filter-toggle");var a=0;let i=(e(".mb2filter-inpt").each(function(){e(this).is(":checked")&&(e(this).val()>0||"filter_price"===e(this).attr("name")&&0==e(this).val())&&a++}),a);0==i?t.find(".criteria-num").remove():(t.find(".criteria-num").remove(),t.append('<span class="criteria-num d-inline-flex ml-2 lhsmall fwbold tsizesmall align-items-center">'+i+"</span>"))},x=function(){v(),f(),g()};return{submitForm:function(){e(document).on("submit",".theme-course-filter",function(e){e.preventDefault(),h(!0),p(),c().then(e=>{d(e)}).catch(Notification.exception)})},pagination:function(){e(document).on("click",".theme-courses-paginitem",function(){let t=e(m().courselist),a=e(this).attr("data-page");if(a==t.attr("data-page"))return null;h(!0),p(),c(a).then(e=>{d(e)}).catch(Notification.exception)})},searchCourses:function(){e(document).on("submit",".theme-course-search",function(t){t.preventDefault();var a=e(this).find("input").val().replace(/<\/?[^>]+(>|$)/g,"").toLowerCase();h(!0),p(),c(1,a).then(e=>{d(e)}).catch(Notification.exception)})},oursesFilters:r}});